<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tacozip | tacozip</title>
    <meta name="description" content="A VitePress site">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/tacozipw/assets/style.COZhih7b.css" as="style">
    <link rel="preload stylesheet" href="/tacozipw/vp-icons.css" as="style">
    
    <script type="module" src="/tacozipw/assets/app.C_13tqCD.js"></script>
    <link rel="preload" href="/tacozipw/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/tacozipw/assets/chunks/theme.Bpwjp-p0.js">
    <link rel="modulepreload" href="/tacozipw/assets/chunks/framework.Dhu4FrKh.js">
    <link rel="modulepreload" href="/tacozipw/assets/en_python_overview.md.ChrE2rJE.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/tacozipw/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>tacozip</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/tacozipw/en/python/overview/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Python</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="#" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>R</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="#" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Julia</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/tacofoundation/tacozip" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://x.com/isp_uv_es" aria-label="twitter" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="mailto:csaybar@gamil.com" aria-label target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.587 1.413T20 20zm8-7l8-5V6l-8 5l-8-5v2z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/tacofoundation/tacozip" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://x.com/isp_uv_es" aria-label="twitter" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-twitter"></span></a><a class="VPSocialLink no-icon" href="mailto:csaybar@gamil.com" aria-label target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.587 1.413T20 20zm8-7l8-5V6l-8 5l-8-5v2z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>API Reference</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/overview.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/getting-started.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Getting started</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/header.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>TACO header</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/client.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Python client</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/python-api-reference.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Python API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/use-cases.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Use cases</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/faq.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>FAQ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><!----><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/CHANGELOG.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Changelog</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/tacozipw/en/python/CONTRIBUTING.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Contributing</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _tacozipw_en_python_overview" data-v-39a288b8><div><h1 id="tacozip" tabindex="-1">Tacozip <a class="header-anchor" href="#tacozip" aria-label="Permalink to &quot;Tacozip&quot;">​</a></h1><h2 id="purpose-and-scope" tabindex="-1">Purpose and scope <a class="header-anchor" href="#purpose-and-scope" aria-label="Permalink to &quot;Purpose and scope&quot;">​</a></h2><p>Tacozip is a specialized ZIP archive library optimized for fast metadata access in cloud storage scenarios. It creates standard ZIP archives with a custom TACO Header at byte 0, enabling metadata retrieval via a single 165-byte read operation instead of scanning the entire Central Directory.</p><p><strong>Key innovation</strong>: Traditional ZIP readers must seek to the archive end to read the Central Directory before accessing metadata. Tacozip eliminates this bottleneck by embedding metadata at the file start, enabling efficient HTTP range requests like <code>Range: bytes=0-164</code>.</p><p>This document covers architecture fundamentals and component relationships. For implementation details, see:</p><ul><li><strong>TACO header format</strong> - Header structure and serialization</li><li><strong>C library reference</strong> - Native API documentation</li><li><strong>Python client</strong> - Python bindings and usage</li><li><strong>Getting started</strong> - Installation and examples</li></ul><h2 id="what-is-tacozip" tabindex="-1">What is <code>tacozip</code>? <a class="header-anchor" href="#what-is-tacozip" aria-label="Permalink to &quot;What is `tacozip`?&quot;">​</a></h2><p>Tacozip addresses the performance penalty of Central Directory scanning in large ZIP archives accessed over HTTP or cloud storage. The library embeds a TACO Header containing up to 7 metadata entries (offset/length pairs) at the archive start, enabling single-request metadata retrieval.</p><h3 id="core-specifications" tabindex="-1">Core specifications <a class="header-anchor" href="#core-specifications" aria-label="Permalink to &quot;Core specifications&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Feature</th><th>Value</th><th>Rationale</th></tr></thead><tbody><tr><td><strong>Compression</strong></td><td>STORE only (method 0)</td><td>Predictable offsets for range requests</td></tr><tr><td><strong>Header size</strong></td><td>165 bytes fixed</td><td>Minimal overhead, single-read access</td></tr><tr><td><strong>Metadata capacity</strong></td><td>7 entries maximum</td><td>Balances flexibility with size constraints</td></tr><tr><td><strong>Archive limit</strong></td><td>4GB (no ZIP64)</td><td>Simplified implementation, common case optimization</td></tr><tr><td><strong>ZIP backend</strong></td><td>libzip 1.11.4</td><td>Production-proven ZIP operations</td></tr><tr><td><strong>CRC32</strong></td><td>zlib 1.3.1</td><td>Fast integrity verification</td></tr></tbody></table><p><strong>Design constraints</strong>:</p><ul><li>Read-optimized: Prioritizes fast metadata access over write performance</li><li>Cloud-native: HTTP range request compatible by design</li><li>Standard-compliant: Regular ZIP format, readable by all ZIP tools</li></ul><h2 id="taco-header" tabindex="-1">TACO header <a class="header-anchor" href="#taco-header" aria-label="Permalink to &quot;TACO header&quot;">​</a></h2><p>The TACO Header is a 165-byte structure at offset 0 containing up to 7 metadata entries (offset/length pairs). It appears as a regular ZIP entry to maintain compatibility with standard tools.</p><p><strong>Key benefits:</strong></p><ul><li><strong>Single-read access</strong>: One 165-byte read retrieves all metadata</li><li><strong>Efficient updates</strong>: Only ~200 bytes written, regardless of archive size</li><li><strong>HTTP friendly</strong>: <code>Range: bytes=0-164</code> retrieves complete metadata in one request</li></ul><p>For complete header specification, see <a href="./header.html">TACO Header Format</a>.</p><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">​</a></h2><p>Tacozip uses a layered architecture separating low-level ZIP manipulation from high-level bindings.</p><h3 id="component-stack" tabindex="-1">Component stack <a class="header-anchor" href="#component-stack" aria-label="Permalink to &quot;Component stack&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌───────────────────────────────────────────────────┐</span></span>
<span class="line"><span>│ Application Layer                                 │</span></span>
<span class="line"><span>│ (User Code)                                       │</span></span>
<span class="line"><span>└───────────────────────────────────────────────────┘</span></span>
<span class="line"><span>                    │</span></span>
<span class="line"><span>┌───────────────────────────────────────────────────┐</span></span>
<span class="line"><span>│ Python API Layer                                  │</span></span>
<span class="line"><span>│ - Public functions (create, read_header, etc.)    │</span></span>
<span class="line"><span>│ - Parameter validation                            │</span></span>
<span class="line"><span>│ - Error handling                                  │</span></span>
<span class="line"><span>└───────────────────────────────────────────────────┘</span></span>
<span class="line"><span>                    │</span></span>
<span class="line"><span>┌───────────────────────────────────────────────────┐</span></span>
<span class="line"><span>│ FFI Layer (ctypes bindings)                       │</span></span>
<span class="line"><span>│ - C structure definitions                         │</span></span>
<span class="line"><span>│ - Function signatures                             │</span></span>
<span class="line"><span>│ - Data marshaling                                 │</span></span>
<span class="line"><span>└───────────────────────────────────────────────────┘</span></span>
<span class="line"><span>                    │</span></span>
<span class="line"><span>┌───────────────────────────────────────────────────┐</span></span>
<span class="line"><span>│ Native Library (C + libzip)                       │</span></span>
<span class="line"><span>│ - ZIP manipulation logic                          │</span></span>
<span class="line"><span>│ - Header serialization                            │</span></span>
<span class="line"><span>│ - File I/O operations                             │</span></span>
<span class="line"><span>└───────────────────────────────────────────────────┘</span></span></code></pre></div><h3 id="dual-api-strategy" tabindex="-1">Dual API strategy <a class="header-anchor" href="#dual-api-strategy" aria-label="Permalink to &quot;Dual API strategy&quot;">​</a></h3><p>Tacozip provides two API levels for different use cases:</p><p><strong>High-Level API</strong> (Convenience):</p><ul><li><code>tacozip_create()</code> - Create archive from files</li><li><code>tacozip_read_header()</code> - Read header from file</li><li><code>tacozip_update_header()</code> - Update header in file</li></ul><p><strong>Low-Level API</strong> (Zero-Copy):</p><ul><li><code>tacozip_parse_header()</code> - Parse header from buffer</li><li><code>tacozip_serialize_header()</code> - Serialize header to buffer</li></ul><p>The low-level API operates on memory buffers without I/O, enabling custom storage backends (S3, Azure Blob, etc.) and zero-copy optimizations.</p><h2 id="core-components" tabindex="-1">Core components <a class="header-anchor" href="#core-components" aria-label="Permalink to &quot;Core components&quot;">​</a></h2><h3 id="native-c-library" tabindex="-1">Native C library <a class="header-anchor" href="#native-c-library" aria-label="Permalink to &quot;Native C library&quot;">​</a></h3><p>The C library (<code>src/tacozip.c</code>) implements all ZIP operations:</p><table tabindex="0"><thead><tr><th>Function</th><th>Purpose</th><th>Key Operations</th></tr></thead><tbody><tr><td><code>tacozip_create</code></td><td>Create archive</td><td>libzip integration, STORE compression enforcement</td></tr><tr><td><code>tacozip_read_header</code></td><td>Read from file</td><td>165-byte read, delegates to parse function</td></tr><tr><td><code>tacozip_parse_header</code></td><td>Parse from buffer</td><td>LFH validation, metadata extraction</td></tr><tr><td><code>tacozip_serialize_header</code></td><td>Serialize to buffer</td><td>CRC32 computation, LFH construction</td></tr><tr><td><code>tacozip_update_header</code></td><td>Update in file</td><td>Atomic 3-location write</td></tr><tr><td><code>tacozip_detect_format</code></td><td>Detect ZIP32/ZIP64</td><td>Format identification for validation</td></tr><tr><td><code>tacozip_validate</code></td><td>Integrity check</td><td>3-level validation (quick/normal/deep)</td></tr></tbody></table><p><strong>Performance optimizations</strong>:</p><ul><li>Direct file manipulation bypasses libzip for updates</li><li>Minimal writes (only changed bytes, not full structures)</li><li>1MB copy buffers for efficient file operations</li><li>Adaptive Central Directory search based on file size</li></ul><h3 id="python-client" tabindex="-1">Python client <a class="header-anchor" href="#python-client" aria-label="Permalink to &quot;Python client&quot;">​</a></h3><p>The Python package (<code>clients/python/tacozip/</code>) provides high-level bindings:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>tacozip/</span></span>
<span class="line"><span>├── __init__.py       # Public API exports</span></span>
<span class="line"><span>├── bindings.py       # ctypes FFI layer</span></span>
<span class="line"><span>├── loader.py         # Library loading and discovery</span></span>
<span class="line"><span>├── config.py         # Constants and error codes</span></span>
<span class="line"><span>├── exceptions.py     # Error handling</span></span>
<span class="line"><span>└── version.py        # Version detection</span></span></code></pre></div><p><strong>Layer responsibilities</strong>:</p><ol><li><strong>Public API</strong> (<code>__init__.py</code>): User-facing functions, parameter validation</li><li><strong>FFI layer</strong> (<code>bindings.py</code>): ctypes structures, function signatures, marshaling</li><li><strong>Loader</strong> (<code>loader.py</code>): Cross-platform library loading</li><li><strong>Config</strong> (<code>config.py</code>): Constants shared with C layer</li></ol><h3 id="data-flow-create-operation" tabindex="-1">Data flow: create operation <a class="header-anchor" href="#data-flow-create-operation" aria-label="Permalink to &quot;Data flow: create operation&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>User Code</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├─&gt; create(zip_path, files, entries)</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>Python API Layer</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├─&gt; Validate inputs</span></span>
<span class="line"><span>    ├─&gt; Prepare ctypes arrays</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>FFI Layer</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├─&gt; Marshal to C types</span></span>
<span class="line"><span>    ├─&gt; Call tacozip_create()</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>C Library</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├─&gt; zip_open() [libzip]</span></span>
<span class="line"><span>    ├─&gt; Add TACO_HEADER entry</span></span>
<span class="line"><span>    ├─&gt; Add user files (STORE only)</span></span>
<span class="line"><span>    ├─&gt; zip_close() [libzip]</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    └─&gt; Return status code</span></span></code></pre></div><h2 id="key-design-decisions" tabindex="-1">Key design decisions <a class="header-anchor" href="#key-design-decisions" aria-label="Permalink to &quot;Key design decisions&quot;">​</a></h2><h3 id="_1-store-only-compression" tabindex="-1">1. STORE-only compression <a class="header-anchor" href="#_1-store-only-compression" aria-label="Permalink to &quot;1. STORE-only compression&quot;">​</a></h3><p><strong>Decision</strong>: Enforce <code>ZIP_CM_STORE</code> (compression method 0) for all entries.</p><p><strong>Rationale</strong>:</p><ul><li>Predictable file offsets enable efficient HTTP range requests</li><li>Zero decompression overhead for cloud workloads</li><li>Simplified implementation without compression algorithm management</li></ul><p><strong>Trade-off</strong>: Larger archive sizes vs. faster access and simpler code</p><h3 id="_2-fixed-165-byte-header" tabindex="-1">2. Fixed 165-byte header <a class="header-anchor" href="#_2-fixed-165-byte-header" aria-label="Permalink to &quot;2. Fixed 165-byte header&quot;">​</a></h3><p><strong>Decision</strong>: TACO Header is exactly 165 bytes (30 LFH + 19 filename + 116 payload).</p><p><strong>Rationale</strong>:</p><ul><li>Single read operation retrieves complete metadata</li><li>Updates don&#39;t require rewriting surrounding structures</li><li>Compatible with standard ZIP readers (appears as regular entry)</li></ul><p><strong>Trade-off</strong>: Fixed size limits metadata capacity vs. update efficiency</p><h3 id="_3-no-zip64-support" tabindex="-1">3. No ZIP64 support <a class="header-anchor" href="#_3-no-zip64-support" aria-label="Permalink to &quot;3. No ZIP64 support&quot;">​</a></h3><p><strong>Decision</strong>: Limit archives to 4GB, no ZIP64 format support.</p><p><strong>Rationale</strong>:</p><ul><li>Simplified implementation (ZIP64 adds significant complexity)</li><li>4GB covers vast majority of use cases</li><li>Reduced code size and maintenance burden</li></ul><p><strong>Trade-off</strong>: Cannot create &gt;4GB archives vs. simpler codebase</p><h3 id="_4-maximum-7-metadata-entries" tabindex="-1">4. Maximum 7 metadata entries <a class="header-anchor" href="#_4-maximum-7-metadata-entries" aria-label="Permalink to &quot;4. Maximum 7 metadata entries&quot;">​</a></h3><p><strong>Decision</strong>: Support up to 7 offset/length pairs in header.</p><p><strong>Rationale</strong>:</p><ul><li>Keeps payload at 116 bytes (fits with 165-byte total)</li><li>Sufficient for common scenarios (multiple Parquet files, etc.)</li><li>Enables efficient in-place updates</li></ul><p><strong>Trade-off</strong>: Limited metadata capacity vs. compact header size</p><h3 id="_5-direct-file-manipulation" tabindex="-1">5. Direct file manipulation <a class="header-anchor" href="#_5-direct-file-manipulation" aria-label="Permalink to &quot;5. Direct file manipulation&quot;">​</a></h3><p><strong>Decision</strong>: Bypass libzip for <code>update_header</code> and <code>validate</code> operations.</p><p><strong>Rationale</strong>:</p><ul><li>Atomic updates with rollback capability</li><li>Minimal rewrites (only changed bytes)</li><li>Fine-grained control over ZIP structures</li></ul><p><strong>Trade-off</strong>: More complex C code vs. better performance</p><h3 id="_6-build-from-source-strategy" tabindex="-1">6. Build from source strategy <a class="header-anchor" href="#_6-build-from-source-strategy" aria-label="Permalink to &quot;6. Build from source strategy&quot;">​</a></h3><p><strong>Decision</strong>: Build libzip from source in CI/CD instead of using system libraries.</p><p><strong>Rationale</strong>:</p><ul><li>Version consistency across platforms</li><li>Controlled dependency management</li><li>Reproducible builds</li></ul><p><strong>Trade-off</strong>: Longer build times vs. consistent behavior</p><h2 id="implementation-highlights" tabindex="-1">Implementation highlights <a class="header-anchor" href="#implementation-highlights" aria-label="Permalink to &quot;Implementation highlights&quot;">​</a></h2><h3 id="memory-management" tabindex="-1">Memory management <a class="header-anchor" href="#memory-management" aria-label="Permalink to &quot;Memory management&quot;">​</a></h3><p><strong>Stack allocation</strong> for fixed-size structures:</p><ul><li>TACO Header uses 165-byte stack buffer</li><li>Predictable memory footprint</li></ul><p><strong>Heap allocation</strong> with explicit cleanup:</p><ul><li>Central Directory buffer allocated dynamically</li><li>Cleanup via <code>goto fail</code> pattern for error paths</li></ul><p><strong>Python GC safety</strong>:</p><ul><li>ctypes structures maintain references during calls</li><li>Prevents premature garbage collection of buffers</li></ul><h3 id="error-handling" tabindex="-1">Error handling <a class="header-anchor" href="#error-handling" aria-label="Permalink to &quot;Error handling&quot;">​</a></h3><p>Consistent patterns across layers:</p><table tabindex="0"><thead><tr><th>Layer</th><th>Mechanism</th><th>Example</th></tr></thead><tbody><tr><td><strong>C library</strong></td><td>Integer return codes</td><td><code>TACOZ_OK (0)</code>, <code>TACOZ_ERR_IO (-1)</code></td></tr><tr><td><strong>Python bindings</strong></td><td>Exceptions</td><td><code>TacozipError</code>, <code>TacozipIOError</code></td></tr><tr><td><strong>CI/CD</strong></td><td>Exit codes</td><td>Non-zero exit on failures</td></tr></tbody></table><p><strong>Error propagation</strong>: C errors → Python exceptions → User code</p><h3 id="platform-compatibility" tabindex="-1">Platform compatibility <a class="header-anchor" href="#platform-compatibility" aria-label="Permalink to &quot;Platform compatibility&quot;">​</a></h3><p><strong>Cross-platform support</strong>:</p><ul><li>Preprocessor directives for platform-specific code</li><li>CMake feature detection (<code>posix_fallocate</code>, etc.)</li><li>Dynamic library naming (<code>.so</code>, <code>.dylib</code>, <code>.dll</code>)</li></ul><p><strong>Tested platforms</strong>:</p><ul><li>Linux (x86_64, ARM64)</li><li>macOS (Intel, Apple Silicon)</li><li>Windows (x64)</li></ul><h2 id="performance-characteristics" tabindex="-1">Performance characteristics <a class="header-anchor" href="#performance-characteristics" aria-label="Permalink to &quot;Performance characteristics&quot;">​</a></h2><h3 id="read-operations" tabindex="-1">Read operations <a class="header-anchor" href="#read-operations" aria-label="Permalink to &quot;Read operations&quot;">​</a></h3><ul><li><strong>Header read</strong>: O(1) - Single 165-byte read at offset 0</li><li><strong>File access</strong>: O(1) - Direct seek using metadata offsets</li><li><strong>Full scan</strong>: Not required - Metadata available immediately</li></ul><h3 id="write-operations" tabindex="-1">Write operations <a class="header-anchor" href="#write-operations" aria-label="Permalink to &quot;Write operations&quot;">​</a></h3><ul><li><strong>Archive creation</strong>: O(n) in number of files</li><li><strong>Header update</strong>: O(1) - Writes 3 locations regardless of archive size</li><li><strong>Validation</strong>: O(n) in validation level (quick/normal/deep)</li></ul><h3 id="comparison-with-standard-zip" tabindex="-1">Comparison with standard ZIP <a class="header-anchor" href="#comparison-with-standard-zip" aria-label="Permalink to &quot;Comparison with standard ZIP&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Operation</th><th>Standard ZIP</th><th>Tacozip</th></tr></thead><tbody><tr><td>Metadata access</td><td>Seek to end, scan CD</td><td>Read 165 bytes at offset 0</td></tr><tr><td>HTTP requests for metadata</td><td>2+ (end, then CD)</td><td>1 (range request)</td></tr><tr><td>Compression overhead</td><td>Variable</td><td>Zero (STORE only)</td></tr><tr><td>Archive size limit</td><td>4GB / 16EB (ZIP64)</td><td>4GB</td></tr></tbody></table><h2 id="next-steps" tabindex="-1">Next steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next steps&quot;">​</a></h2><p><strong>For Python users:</strong></p><ul><li>Start with <a href="./getting-started.html">Getting Started</a> for installation and basic usage</li><li>Review <a href="./client.html">Python Client</a> for Python-specific features</li><li>See <a href="./use-cases.html">Use Cases</a> for real-world examples</li></ul><p><strong>For C developers:</strong></p><ul><li>Read <a href="#">C API Reference</a> for native library details</li><li>Study <a href="./header.html">TACO Header Format</a> for specification details</li></ul><p><strong>For contributors:</strong></p><ul><li>Review <a href="./CONTRIBUTING.html">Contributing Guidelines</a> for code standards</li></ul></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><div class="edit-info" data-v-e257564d><div class="edit-link" data-v-e257564d><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/tacofoundation/tacozipw/edit/main/docs/en/python/overview.md" target="_blank" rel="noreferrer" data-v-e257564d><!--[--><span class="vpi-square-pen edit-link-icon" data-v-e257564d></span> Edit this page on GitHub<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/tacozipw/en/python/getting-started.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Getting started</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Released under the MIT License.</p><p class="copyright" data-v-e315a0ad>© 2025 tacozip | open source for a better tomorrow</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"en_python_changelog.md\":\"Ck40dG0z\",\"en_python_client.md\":\"PuSGjJ7V\",\"en_python_contributing.md\":\"DlvPPYj-\",\"en_python_create.md\":\"Dcu-lXuk\",\"en_python_faq.md\":\"CImD3Msx\",\"en_python_getting-started.md\":\"XcEaHrP_\",\"en_python_header.md\":\"DV-crt3r\",\"en_python_overview.md\":\"ChrE2rJE\",\"en_python_python-api-reference.md\":\"bcNzYyX9\",\"en_python_use-cases.md\":\"BVG4DLUt\",\"en_python_validation.md\":\"0xw3d_X7\",\"index.md\":\"BHTpYvTg\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"tacozip\",\"description\":\"A VitePress site\",\"base\":\"/tacozipw/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Python\",\"link\":\"/en/python/overview/\",\"activeMatch\":\"/en/python/\"},{\"text\":\"R\",\"link\":\"#\"},{\"text\":\"Julia\",\"link\":\"#\"}],\"search\":{\"provider\":\"local\"},\"sidebar\":{\"/en/python/\":{\"base\":\"/en/python/\",\"items\":[{\"text\":\"API Reference\",\"items\":[{\"text\":\"Overview\",\"link\":\"overview\"},{\"text\":\"Getting started\",\"link\":\"getting-started\"},{\"text\":\"TACO header\",\"link\":\"header\"},{\"text\":\"Python client\",\"link\":\"client\"},{\"text\":\"Python API\",\"link\":\"python-api-reference\"},{\"text\":\"Use cases\",\"link\":\"use-cases\"},{\"text\":\"FAQ\",\"link\":\"faq\"}]},{\"items\":[{\"text\":\"Changelog\",\"link\":\"CHANGELOG.md\"},{\"text\":\"Contributing\",\"link\":\"CONTRIBUTING.md\"}]}]}},\"editLink\":{\"pattern\":\"https://github.com/tacofoundation/tacozipw/edit/main/docs/:path\",\"text\":\"Edit this page on GitHub\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/tacofoundation/tacozip\"},{\"icon\":\"twitter\",\"link\":\"https://x.com/isp_uv_es\"},{\"icon\":{\"svg\":\"\\n          <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\"><path fill=\\\"currentColor\\\" d=\\\"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.587 1.413T20 20zm8-7l8-5V6l-8 5l-8-5v2z\\\"/></svg>\"},\"link\":\"mailto:csaybar@gamil.com\"}],\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"© 2025 tacozip | open source for a better tomorrow\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>